
#
# A simple program and associated instructions for interracting with AXI
# bus channels.
#

using instructions "generic-instrs.txt"
using subprogram   "axi-lib.txt"


reg recieved [7:0]


block main
    axi_ar_cfg  2 0 0 0 0 3'b010 0 0
    axi_aw_cfg  2 0 0 0 0 3'b010 0 0 4'hF
    axi_set     m_axi_araddr    4'h0
    axi_set     axi_ret         0
    goto        setup_uart_module

block setup_uart_module
    axi_set     m_axi_awaddr    4'hC
    axi_set     m_axi_wdata     32'b10011
    axi_set     axi_ret         0
    axi_set     axi_ra          _current_state_
    ifeqz       axi_ret         axi_st_w
    ifnez       axi_ret         loop_main


block loop_main
    goto        get_uart_status

block get_uart_status
    goto        loop_main
    
    
